from uaclient import messages
from uaclient.cli.commands import ProCommand
from uaclient.cli.vulnerability.show import show_subcommand
from uaclient.cli.vulnerability.update import update_subcommand


def action_vulnerability(args, *, cfg, **kwargs):
    # Avoiding a circular import
    from uaclient.cli import get_parser

    get_parser().print_help_for_command("vulnerability")


vulnerability_command = ProCommand(
    "vulnerability",
    help=messages.CLI_ROOT_VULNERABILITY,
    description=messages.CLI_VULNERABILITY_DESC,
    action=action_vulnerability,
    subcommands=[show_subcommand, update_subcommand],
)
