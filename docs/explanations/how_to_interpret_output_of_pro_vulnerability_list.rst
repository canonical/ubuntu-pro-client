.. _pro-vulnerability-list:

How to interpret the output of pro vulnerability list
********************************************************

In the Pro Client version 35, we introduce the ``pro vulnerability list`` command.
This commands will display by default all the CVEs that are currently affecting the
system. Let's take a look on an example when running this command:

.. code-block:: text

    Common vulnerabilities and exposures (CVE):
    VULNERABILITY     PRIORITY    FIX AVAILABLE FROM  AFFECTED INSTALLED PACKAGES
    CVE-2021-44730    critical    esm-infra           snapd
    CVE-2021-44731    high        esm-infra           snapd
    CVE-2022-3328     high        security            snapd
    CVE-2019-11922    medium      esm-infra           libzstd1
    CVE-2021-3155     medium      esm-infra           snapd
    CVE-2021-4120     medium      esm-infra           snapd
    CVE-2023-1523     medium      esm-infra           snapd
    CVE-2021-46848    low         security            libtasn1-6
    CVE-2023-24626    low         esm-infra           screen
    CVE-2018-1000654  negligible  esm-infra           libtasn1-6

    Vulnerabilities with applied fixes:
        13 applied via Ubuntu Security (2 high, 6 medium, 5 low)

    Vulnerabilities with fixes available:
        8 fixable via Ubuntu Pro (1 critical, 1 high, 4 medium, 1 low, 1 negligible)
        2 fixable via Ubuntu Security (1 high, 1 low)

We can see that the command has three distinct sections. Let's analyze each of them:

.. code-block:: text

    Common vulnerabilities and exposures (CVE):
    VULNERABILITY     PRIORITY    FIX AVAILABLE FROM  AFFECTED INSTALLED PACKAGES
    CVE-2021-44730    critical    esm-infra           snapd
    CVE-2021-44731    high        esm-infra           snapd
    CVE-2022-3328     high        security            snapd
    CVE-2019-11922    medium      esm-infra           libzstd1
    CVE-2021-3155     medium      esm-infra           snapd
    CVE-2021-4120     medium      esm-infra           snapd
    CVE-2023-1523     medium      esm-infra           snapd
    CVE-2021-46848    low         security            libtasn1-6
    CVE-2023-24626    low         esm-infra           screen
    CVE-2018-1000654  negligible  esm-infra           libtasn1-6

The first part of the output is a table showing all **fixable** CVEs in the system.
The table contains these four distinct columns:

* **VULNERABILITY**: The name of the CVE
* **PRIORITY**: The ubuntu priority for the CVE
* **FIX AVAILABLE FROM**: The ubuntu pocket where the fix can be found:
	* **esm-infra**: Fix is availabe on the esm-infra pocket. This means that user must have esm-infra service enabled through Pro in the machine to access it
	* **esm-apps**: Fix is availabe on the esm-apps pocket. This means that user must have esm-apps service enabled through Pro in the machine to access it
	* **fips**:     Fix is availabe on the fips pocket. This means that user must have fips service enabled through Pro in the machine to access it
	* **fips-updates**: Fix is availabe on the fips-updates pocket. This means that user must have fips-updates service enabled through Pro in the machine to access it
	* **security**: The ubuntu security pocket
	* **updates**: The ubuntu updates pocket
	* **no-fix**: No fix is yet available for this CVE
* **AFFECTED INSTALLED PACKAGES**: The affected installed packages related to the CVE

Finally, note that the table is ordered by **PRIORITY**. This means that CVEs with higher
priority will appear first on the table.

Now, let's look at the next section:

.. code-block:: text

    Vulnerabilities with applied fixes:
        13 applied via Ubuntu Security (2 high, 6 medium, 5 low)

This section details the CVEs that already have fixes applied for them.
For example, suppose we have a CVE named **CVE-2021-12345** and this
CVE affects two packages, pkg1 and pkg2. If the we detect that pkg1 is already fixed
in the machine even if pkg2 is still affected, we will count this CVE here.

Therefore, this section presents a summary of all CVEs that have at least **one** fix already
applied for it. Addionally, note that we also display the count by ubuntu priority as well.

Finally, let's look at the last section:

.. code-block:: text

    Vulnerabilities with fixes available:
        8 fixable via Ubuntu Pro (1 critical, 1 high, 4 medium, 1 low, 1 negligible)
        2 fixable via Ubuntu Security (1 high, 1 low)

While the previous section show CVEs with fixes already applied, this section show CVE with fixes
available, but not yet applied. This means that the user can actively fix those issues by upgrading
the affected packages. However, note that we also split by the type of service. If the fix is
available by a service that requires Pro, it will go under **Ubuntu Pro**. If that is not the case,
we will classify the CVE as **Ubuntu Security** instead. This means that some fixes will only be available
if the user is attached to a Pro subscription and have the necessary service enabled (i.e. esm-infra).

Finally, note that we also group the count by ubuntu priority here as well. If the table is too long,
breaking the count by priority allows user to better visualize the overal risk of the CVEs without the
need to look at the whole table to access that information.
