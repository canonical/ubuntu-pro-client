.. _pro-vulnerability-list:

The pro vulnerability list command
********************************************************

In the Pro Client version 35, we introduce the ``pro vulnerability list`` command.
This command displays all the CVEs currently affecting the
system. Let's take a look at an example when running this command:

.. code-block:: text

    Common vulnerabilities and exposures (CVE):
    VULNERABILITY     PRIORITY    FIX AVAILABLE FROM  AFFECTED INSTALLED PACKAGES
    CVE-2021-44730    critical    esm-infra           snapd
    CVE-2021-44731    high        esm-infra           snapd
    CVE-2022-3328     high        security            snapd
    CVE-2019-11922    medium      esm-infra           libzstd1
    CVE-2021-3155     medium      esm-infra           snapd
    CVE-2021-4120     medium      esm-infra           snapd
    CVE-2023-1523     medium      esm-infra           snapd
    CVE-2021-46848    low         security            libtasn1-6
    CVE-2023-24626    low         esm-infra           screen
    CVE-2018-1000654  negligible  esm-infra           libtasn1-6

    Vulnerabilities with applied fixes:
        13 applied via Ubuntu Security (2 high, 6 medium, 5 low)

    Vulnerabilities with fixes available:
        8 fixable via Ubuntu Pro (1 critical, 1 high, 4 medium, 1 low, 1 negligible)
        2 fixable via Ubuntu Security (1 high, 1 low)

We can see that the command has three distinct sections. Let's analyse each of them:

.. code-block:: text

    Common vulnerabilities and exposures (CVE):
    VULNERABILITY     PRIORITY    FIX AVAILABLE FROM  AFFECTED INSTALLED PACKAGES
    CVE-2021-44730    critical    esm-infra           snapd
    CVE-2021-44731    high        esm-infra           snapd
    CVE-2022-3328     high        security            snapd
    CVE-2019-11922    medium      esm-infra           libzstd1
    CVE-2021-3155     medium      esm-infra           snapd
    CVE-2021-4120     medium      esm-infra           snapd
    CVE-2023-1523     medium      esm-infra           snapd
    CVE-2021-46848    low         security            libtasn1-6
    CVE-2023-24626    low         esm-infra           screen
    CVE-2018-1000654  negligible  esm-infra           libtasn1-6

The first part of the output is a table showing all **fixable** CVEs in the system.
The table contains these four distinct columns:

* **VULNERABILITY**: The name of the CVE.
* **PRIORITY**: The Ubuntu priority for the CVE.
* **FIX AVAILABLE FROM**: The Ubuntu pocket where the fix can be found:
	* ``esm-infra``: Fix is availabe from the ``esm-infra`` pocket. The user must have the ``esm-infra`` service enabled through Pro on the machine to access it.
	* ``esm-apps``: Fix is availabe from the ``esm-apps`` pocket. The user must have the ``esm-apps`` service enabled through Pro on the machine to access it.
	* ``fips``:     Fix is availabe from the ``fips`` pocket. The user must have the ``fips`` service enabled through Pro on the machine to access it.
	* ``fips-updates``: Fix is availabe from the ``fips-updates`` pocket. The user must have the ``fips-updates`` service enabled through Pro on the machine to access it.
	* ``security``: The Ubuntu ``security`` pocket.
	* ``updates``: The Ubuntu ``updates`` pocket.
	* ``no-fix``: No fix is available yet for this CVE.
* **AFFECTED INSTALLED PACKAGES**: The installed packages affected by the CVE.

Finally, note that the table is ordered by **PRIORITY**. This means that CVEs with higher
priority will appear first in the table.

Now, let's look at the next section:

.. code-block:: text

    Vulnerabilities with applied fixes:
        13 applied via Ubuntu Security (2 high, 6 medium, 5 low)

This section details the CVEs that already have fixes applied for them.
For example, suppose we have a CVE named **CVE-2021-12345** and this
CVE affects two packages, ``pkg1`` and ``pkg2``. If the we detect that ``pkg1`` is already fixed
on the machine, then even if ``pkg2`` is still affected, we include this CVE here.

Therefore, this section presents a summary of all CVEs that have at least **one** fix already
applied for it. Note that we also order the count by Ubuntu priority as well.

Finally, let's look at the last section:

.. code-block:: text

    Vulnerabilities with fixes available:
        8 fixable via Ubuntu Pro (1 critical, 1 high, 4 medium, 1 low, 1 negligible)
        2 fixable via Ubuntu Security (1 high, 1 low)

While the previous section showed CVEs with fixes already applied, this section shows CVEs with fixes
available, but not yet applied. The user can actively fix those CVEs by upgrading
the affected packages. However, note that we also split the vulnerability according to the source of
the fix. If the fix is
available from a service that requires Pro, it will fall under **Ubuntu Pro**. Otherwise,
we will classify the CVE as falling under **Ubuntu Security** instead. This means that some fixes will only be available
if the user is attached to a Pro subscription and has the necessary service enabled (i.e. ``esm-infra``).

Note that we group the count by Ubuntu priority here as well. If the table is long,
breaking the count by priority provides better visualisation of the overall risk of the CVEs.
